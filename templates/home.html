{% extends "base.html" %}
{% block content %}

  <div class="list-books-title">
      <h1>Welcome to the Alchemy Bookstore</h1>
      <form method="GET" action="{{ url_for('home') }}">
        <input type="text" name="q" placeholder="Search by title or author" value="{{ search_query }}">
        <button type="submit">Search</button>
      </form>
      <a href="{{ url_for('home', sort_by='title') }}">Sort by Title</a> |
      <a href="{{ url_for('home', sort_by='author') }}">Sort by Author</a> |
      <a href="{{ url_for('home', sort_by='year') }}">Sort by Year</a>
  </div>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="container mt-3">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}
  <div>
    <ol class="book-grid">
      {% for book in books %}
        <li>
          <div class="book">
            <img class="book-poster" src={{ book.cover_url }} title=""/>
            <div class="book-title">{{ book.title }}</div>
            <div class="book-author">{{ book.author.name }}</div>
            <form action="{{ url_for('delete_book', book_id=book.id) }}" method="POST" style="display:inline;">
              <button type="submit" onclick="return confirm('Are you sure you want to delete this book?');">
                  Delete Book
              </button>
            </form>
          </div>
        </li>
      {% endfor %}
    </ol>
  </div>

{% endblock %}
